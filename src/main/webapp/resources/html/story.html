<!DOCTYPE html>
<div data-ng-controller="storyCtrl">
	<!-- Story button, with modal attachment -->
	<button class="button button-primary" data-toggle="modal"
		data-ng-click="setNewTaskStory(story)"
		data-ng-attr-data-target="{{ '#modal' + story.id }}">({{story.points}}) {{story.title}}</button>
	<br>
	
	<!-- Modal -->
	<div class="modal fade" data-ng-attr-id="{{ 'modal' + story.id }}"
		tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						data-ng-click="resetNewTask(); reset()" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<div data-ng-hide="editing">
						<h4 class="modal-title" id="myModalLabel">({{story.points}}) {{story.title}}</h4>
					</div>
					<div data-ng-if="editing">
						<input type=number " data-ng-model="story.points" min=1 max=10 required />
						<input type="text" data-ng-model="story.title" required />
					</div>
				</div>
				<div class="modal-body">
					<h5>Description</h5>
					<div data-ng-if="editing">
						<textarea data-ng-model="story.description"></textarea>
					</div>
					<div data-ng-hide="editing">
						<span data-ng-if="story.description">&emsp;{{story.description}}</span>
						<span data-ng-hide="story.description">&emsp;No description</span>
						<br><br>
						<h5>Tasks</h5>
						<div data-ng-if="story.tasks.length == 0">&emsp;No tasks yet
						</div>
						<table class="table table-hover table-condensed">
							<tr data-ng-repeat="task in story.tasks">
								<td><scrum-task task="task" story="story"></scrum-task></td>
							</tr>
						</table>
						<form>
							&emsp; <input type="text" data-ng-model="newTask.name" required />
							<button class="btn btn-default" data-ng-click="createTask()">Add
								Task</button>
						</form>
					</div>
				</div>
				<div class="modal-footer">
					<div data-ng-hide="editing">
						<button type="button" class="btn btn-default"
							data-ng-click="resetNewTask(); edit()">
							<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-danger" data-ng-click=""
							data-dismiss="modal">
							<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
						</button>
					</div>
					<div data-ng-if="editing">
						<button type="button" class="btn btn-success"
							data-ng-click="update()">
							<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-danger"
							data-ng-click="reset()">
							<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
						</button>
					</div>
				</div>
			</div> <!-- modal-content -->
		</div> <!-- modal-dialog -->
	</div> <!-- modal -->
</div> <!-- storyCtrl -->